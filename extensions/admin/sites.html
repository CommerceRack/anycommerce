


<div id='pageTemplateSites' class='ui-widget smallButton'>


	<section class='marginBottom' data-app-role='domainsAndHostsContainer'>
	<div class="ui-widget-header ui-widget-header-padding ui-corner-top">
		<h2 class="smallPadding">Domains &amp; Hosts</h2>
	</div>
	<div class='ui-widget-content ui-corner-all stdPadding'>
	<table class='fullWidth gridTable marginTop applyAnytable' data-app-role='domainListNonFavorites' data-bind="var: domains(@DOMAINS); format:processList; loadsTemplate:domainListTemplate;">
	<thead>
	<tr>
		<th>Domain/Host</th>
		<th>Type</th>
		<th>Project</th>
		<th data-anytable-nosort='true'></th>
	</tr>
	</thead>
	<tfoot>
	<tr>
		<td colspan='5'>
		<input name='tableSearchQuery' type='search' placeholder='filter value' data-app-keyup="admin|tableFilter" />
		</td>
	</tr>
	</tfoot>
	</table>
	</div>

	</section>
	
	<section data-app-role='projectsContainer'>
	<div class="ui-widget-header ui-widget-header-padding ui-corner-top">
		<button class='applyButton floatRight' data-icon-primary='ui-icon-plus' data-app-click='admin_sites|projectCreateShow'>Add Project</button>
		<h2 class="smallPadding">Projects</h2>
	</div>
	<div class='ui-widget-content ui-corner-all stdPadding'>
	<table class='fullWidth gridTable marginTop applyAnytable' data-bind="var: projects(@PROJECTS); format:processList; loadsTemplate:projectsListTemplate;">
	<thead>
	<tr>
		<th>Title</th>
		<th>Type</th>
		<th data-anytable-nosort='true'></th>
	</tr>
	</thead>
	<tfoot>
	<tr>
		<td colspan='4'>
		<input name='tableSearchQuery' type='search' placeholder='filter value' data-app-keyup="admin|tableFilter" />
		</td>
	</tr>
	</tfoot>
	</table>
	</div>
	
	</section>

	
</div>




<table>

<tbody id='domainListTemplate' data-bind="var: domain(@HOSTS); format:processList; loadsTemplate:domainListHostsRowTemplate;" data-element='domain'>
<tr>
	<td colspan='3' class='isSearchable'><h6 class='displayInline' data-bind="var: domain(DOMAINNAME); format:text;"></h6></td>
	<td class='alignRight'>
		<button class='applyButton' data-icon-primary='ui-icon-info' data-text='false' data-app-click="admin|showMenu">Show Domain Menu</button>
		<menu class='displayNone'>
		<li><a href='#' data-app-click='admin_batchJob|adminBatchJobExec' data-whitelist='DOMAINNAME,PRT' data-type='UTILITY/SITEMAP'>Update Sitemap</a></li>
		<li><a href='#' data-app-click="admin_sites|domainPutInFocus">Use This Domain</a></li>
		<li><a href='#' data-app-click="admin_sites|adminDomainToggleFavoriteExec">Tag as Favorite</a></li>
		<li><a href='#' data-app-click="admin_sites|adminDomainDetailShow" data-mode='dialog'>Edit Domain Settings</a></li>
		</menu>
	</td>
</tr>
</tbody>



<tr id='domainListHostsRowTemplate'  data-element='host'>
	<td class='isSearchable' data-bind="var: host(HOSTNAME); format:text;"></td>
	<td class='isSearchable' data-bind="var: domain(HOSTTYPE); format:text; hideZero:false;"></td>
	<td class='isSearchable' data-bind="var: domain(PROJECT); format:projectID2Pretty; extension:admin_sites;"></td>
	<td class='alignRight width50'>
	<button class='applyButton' data-text='false' data-icon-primary='ui-icon-newwin' data-app-click="admin_sites|domainView" data-mode='host'>View Site</button><!-- buttons that always show up should be on the right so they don't move -->
	<span data-bind="var: host(HOSTTYPE); format:appHostButtons; extension:admin_sites;"></span>
	</td>
</tr>




<tr id='domainManagerRowTemplate'>
	<td class='alignCenter width1' ><img src='blank.gif' class='prodThumb' data-bind='useParentData:1; format:companyLogo; extension:admin;' width='80' height='40' /></td>
	<td data-bind="var: domain(DOMAINNAME); format:text;"></td>
	<td data-bind="var: domain(PRT); format:text; hideZero:false;"></td>
	<td class='alignRight'>
		<button data-app-event="admin_config|domainRemoveConfirm">Remove Domain</button>
		<button data-app-event="admin_config|adminDomainToggleFavoriteExec">Flag as Favorite</button>
		<button data-app-event="admin_config|adminDomainDetailShow" data-mode='panel'>Edit Domain</button>
	</td>
</tr>


<tr id='domainManagerHistoryRowTemplate'>
	<td data-bind="var: domain(DOMAINNAME); format:text;"></td>
	<td data-bind="var: domain(TXT); format:text;"></td>
	<td data-bind="var: domain(CLASS); format:text;"></td>
	<td data-bind="var: domain(CREATED_GMT); format:epoch2pretty;"></td>
</tr>


<tr id='domainManagerRewriteRowTemplate'>
	<td data-bind="var: domain(PATH); format:text;"></td>
	<td data-bind="var: domain(TXT); format:text;"></td>
	<td>
	<button data-app-event="admin|tagRowForRemove">Delete Rule</button>
	</td>
</tr>

<tr id='domainManagerHostsRowTemplate'>
	<td data-bind="var: domain(HOSTNAME); format:text;"></td>
	<td data-bind="var: domain(HOSTTYPE); format:text;"></td>
	<td>
		<div data-bind="var: domain(PROJECT); format:text;"></div>
		<div data-bind="var: domain(@REWRITES.length); format:text; posttext: rewrites;"></div>
	</td>
	<td class='alignRight'>
	<button data-app-event="admin_sites|domainView" data-mode='host'>View Site</button>
	<button data-app-event="admin|tagRowForRemove">Delete this Host</button>
	<button data-app-event='admin_sites|adminDomainCreateUpdateHostShow' data-mode='update'>Edit Host</button>
	</td>
</tr>

<tr id='domainManagerDiagnosticsRowTemplate'>
	<td data-bind="var: domain(_); format:text;"></td>
	<td data-bind="var: domain(+); format:text;"></td>
	<td data-bind="var: domain(!); format:text;"></td>
</tr>


</table>












<div id='domainCreateTemplate'>
<form action='#' onSubmit='return false'>

<input type='hidden' name='_macrobuilder' value='admin_config|adminDomainMacroCreate' />
<input type='hidden' name='_tag/callback' value='showMessaging' />
<input type='hidden' name='_tag/restoreInputsFromTrackingState' value='1' />
<input type='hidden' name='_tag/jqObjEmpty' value='true' />
<input type='hidden' name='_tag/message' value='The domain has been added.' />

<fieldset class='labelsAsBreaks alignedLabels'>
	
	<label>
		<span>Type</span>
		<select name='domaintype' required='required' data-panel-selector=".domainCreateDomaintype" data-input-change="panel-selector">
			<option value='DOMAIN-DELEGATE' data-show-panel='domainCreateDomaintypeDelegate'>Delegate domain</option>
			<option value='DOMAIN-RESERVE'>Reserve test domain</option>
		</select>
	</label>

	<div data-panel-id='domainCreateDomaintypeDelegate' class='displayNone domainCreateDomaintype'>
	<label>
		<span>Domain</span>
		<input type='text' name='DOMAINNAME' value='' />
	</label>
	</div>
	
	
</fieldset>

<div class='buttonset alignRight'>
	<button data-app-event='admin|processForm'>Save Domain</button>
</div>

</form>
</div>



<div id='domainAddUpdateHostTemplate'>
<form action='#' onSubmit='return false' class='labelsAsBreaks alignedLabels'>
	<input type="hidden" name="DOMAINNAME" data-bind="var:domain(DOMAINNAME); format:popVal;" />

	<fieldset>
	
	<label>
		<span>Host name</span>
		<input type='text' name='HOSTNAME' data-bind="var: host(HOSTNAME); format:popVal;" required='required'  />
	</label>
<!-- the save for this looks for specific host types to generate the macro. don't change these without updating admin_config.u.domainAddUpdateHost -->
	<label>
		<span>Host Type</span>
		<select name='HOSTTYPE' data-input-change="panel-selector" data-panel-selector=".domainNewHostSelectType" required='required' data-bind="var: host(HOSTTYPE); format:popVal;">
			<option value='SITE' data-show-panel='domainForceHTTPS' data-bind="var:domain(DOMAINNAME); format:text; posttext: project;">Domain project</option>
			<option value='SITEPTR' data-show-panel='domainNewHostTypeSITEPTR,domainForceHTTPS'>Other project reference</option>
<!--			<option value='ADMIN'>Admin</option> -->
			<option value='REDIR' data-show-panel='domainNewHostTypeREDIR'>Redirect</option>
			<option value='VSTORE' data-show-panel='domainNewHostTypeVSTORE'>V-Store</option>
			<option value='CUSTOM'>Custom</option>
		</select>
		<span class='toolTip' title="brian will fill this in later. !!!">?</span>
	</label>

	</fieldset>


<!-- these are the 'panels' for the host type select list -->
	<div data-panel-id='domainNewHostTypeSITEPTR' class='displayNone domainNewHostSelectType'>
		<label>
			<span>Project Reference</span>
			<select name='PROJECT' data-bind="var: project(@PROJECTS); format: optionsFromList; value:UUID; text:TITLE;">
			<option value=''></option>
			</select>
		</label>
	</div>

	<div data-panel-id='domainForceHTTPS' class='displayNone domainNewHostSelectType'>
	<label class='applyAnycb'>
		<input type='checkbox' name='force_https' data-bind="var: host(force_https); format:popval;" />
		Force https
	</label>
	
	</div>


	<div data-panel-id='domainNewHostTypeREDIR' class='displayNone domainNewHostSelectType'>
		<label>
			<span>Redirect</span>
			<input type='text' name='REDIR' value='' />
		</label>
		<label>
			<span>Project</span>
			<input type='text' name='URI' value='' />
		</label>
	</div>
	<div data-panel-id='domainNewHostTypeVSTORE' class='displayNone domainNewHostSelectType hint'>

	<fieldset class='alignedInputs'>
		<legend>Rewrite Rules</legend>
		<label>
			<span>Incoming URL</span>
			<input type='url' required='required' name='PATH' value='' />
		</label>
		<label>
			<span>Rewrite to</span>
			<input type='url' required='required' name='TARGETURL' value='' />
		</label>
		<button data-app-event='admin_config|dataTableAddExec' data-form-skipreset='true'>Apply</button><!-- needs to be within fieldset for taxTableUpdateExec -->
		
		<table class='marginTop applyAnytable gridTable fullWidth' data-app-role='dataTable'>
		<thead>
		<tr>
			<td>Incoming URL</td>
			<td>Destination URL</td>
			<td></td>
		</tr>
		</thead>
		<tbody data-bind="var: shipping(@REWRITES); format:processList; loadsTemplate:domainManagerRewriteRowTemplate;" data-app-role='domainRewriteRulesTbody'></tbody>
		</table>


	</fieldset>	
	
	</div>






	<div class='buttonset alignRight'></div><!-- save button added here w/ JS -->
	
</form>
</div>




<div id='domainUpdateTemplate'>

	<div data-app-role='tabContainer' class='applyAnytabs'>
	<ul>
		<li><a href='#domainGeneral'>General</a></li>
		<li><a href='#domainEmail'>Email</a></li>
		<li><a href='#domainEvents'>Events</a></li>
		<li><a href='#domainDiagnostics' data-app-click="admin_config|adminDomainDiagnosticsShow" data-bind='var:domain(DOMAINNAME); format:assignAttribute; attribute:data-domainname;'>Diagnostics</a></li>
<!--		<li><a href='#domainRewriteRules'>Rewrite Rules</a></li> -->
	</ul>
	
	
	<section data-anytab-content='domainGeneral' class='clearfix'>
	<form action='#' onSubmit='return false' class='labelsAsBreaks alignedLabels'>
	<input type='hidden' name='_macrobuilder' value='admin_config|adminDomainMacroGeneral' />
	<input type='hidden' name='_tag/callback' value='showMessaging' />
	<input type='hidden' name='_tag/restoreInputsFromTrackingState' value='1' />
	<input type='hidden' name='_tag/message' value='The domain has been successfully updated.' />
	<input type="hidden" name="DOMAINNAME" data-bind="var:domain(DOMAINNAME); format:popVal;" />

	<input type='hidden' name='LOGO' value='' data-bind="var:domain(LOGO); format:popVal;" />


	<div class='buttonset alignRight marginBottom'>
	<button data-app-event='admin_config|adminDomainCreateUpdateHostShow' data-mode='create'>Add Host</button>
	<button data-app-role='saveButton' disabled='disabled' data-app-event='admin|processForm'>Save <span class='numChanges'></span> Changes</button>
	</div>

	<fieldset class='marginBottom'>
		<legend>General</legend>
		<div class='floatRight pointer ui-widget-content smallPadding ui-corner-all'><img src='blank.gif' class='prodThumb' data-bind='useParentData:1; format:companyLogo; extension:admin;' width='150' height='50' onClick="mediaLibrary($(this),$(this).closest('form').find('input[name=\'LOGO\']').first(),'');" /></div>
		<h5 data-bind="var: domain(DOMAINNAME); format:text;"></h5>
		
		<label>
			<input type='checkbox' class='applyAnycb' name='IS_PRIMARY'  data-bind="var: domain(IS_PRIMARY); format:popVal;" />
			Tag as primary
			<span class='toolTip' title="Only 1 primary domain per partition.">?</span>
		</label>		

		<label>
			<input type='checkbox' class='applyAnycb' name='IS_SYNDICATION'  data-bind="var: domain(IS_SYNDICATION); format:popVal;" />
			Enable syndication
		</label>
		
		
		<label>
			<span>Partition</span>
			<select name='PRT' data-bind="var: partitions(@PRTS); format: optionsFromList; value:id; text:id;"></select>
		</label>
<!--		<div data-bind="var: domain(PRT); format:text; pretext:Partition: ; hideZero:false;"></div> -->
		
<!--		<div data-bind="var: domain(@READONLY.IS_PRT_PRIMARY); format:text; pretext:Is partition primary: ;"></div>
		<div>Syndication: <span data-bind="var: domain(@READONLY.SYNDICATION_ENABLE); format:text; defaultValue:disabled;"></span></div> -->
		<div data-bind="var: domain(@READONLY.REG_TYPE); format:text; pretext:Registrar: ;"></div>
		<div data-bind="var: domain(@READONLY.REG_TYPE_TXT); format:text;" class='hint'></div>
		
	</fieldset>
	
	
	<fieldset>
		<legend>Hosts</legend>
		
		<table class='fullWidth gridTable applyAnytable' data-bind="var:domain(DOMAINNAME); format:assignAttribute; attribute:data-domain;">
		<thead>
		<tr>
			<td>Name</td>
			<td>Type</td>
			<td>More</td>
			<td></td>
		</tr>
		</thead>
		<tbody data-bind="var: domain(@HOSTS); format:processList; loadsTemplate:domainManagerHostsRowTemplate;" data-app-role='domainsHostsTbody'></tbody>
		</table>
		
	</fieldset>
	


	</form>
	</section>
	
	<section data-anytab-content='domainEmail' class='clearfix'>
	
		<form action='#' onSubmit='return false' class='labelsAsBreaks alignedLabels'>

		<div class='buttonset alignRight marginBottom'>
		<button data-app-role='saveButton' disabled='disabled' data-app-event='admin|processForm'>Save <span class='numChanges'></span> Changes</button>
		</div>

		<input type='hidden' name='_macrobuilder' value='admin_config|adminDomainMacroEmail' />
		<input type='hidden' name='_tag/callback' value='showMessaging' />
		<input type='hidden' name='_tag/restoreInputsFromTrackingState' value='1' />
		<input type='hidden' name='_tag/message' value='The domain has been successfully updated.' />
		<input type="hidden" name="DOMAINNAME" data-bind="var:domain(DOMAINNAME); format:popVal;" />
		
		<fieldset>
			<legend>Email</legend>
			
			<label>
				<span>Configuration</span>
				<select name='TYPE' data-input-change="panel-selector" data-bind="var: plugin(%EMAIL.TYPE); format:popVal;" data-panel-selector=".domainEmailConfiguration">
					<option value=''>None</option>
					<option value='MX' data-show-panel='domainEmailConfigurationMX'>MX</option>
					<option value='GOOGLE'>Google</option>
					<option value='FUSEMAIL'>Fusemail</option>
				</select>
			</label>
			
			<div data-panel-id='domainEmailConfigurationMX' class='displayNone domainEmailConfiguration'>
	
				<label>
					<span>MX1</span>
					<input type="text" name="MX1" value="" size="25" data-bind="var:vendor(%EMAIL.MX1); format:popVal;" />
				</label>
				<label>
					<span>MX2</span>
					<input type="text" name="MX2" value="" size="25" data-bind="var:vendor(%EMAIL.MX2); format:popVal;" />
				</label>
			</div>
		</fieldset>
		</form>
	</section>



	<section data-anytab-content='domainDiagnostics' class='clearfix'>
	<table class='applyAnytable gridTable fullWidth'>
	<thead>
	<tr>
		<td>Type</td>
		<td>Message</td>
		<td></td>
	</tr>
	</thead>
	<tbody data-bind="var: shipping(@MSGS); format:processList; loadsTemplate:domainManagerDiagnosticsRowTemplate;"></tbody>
	</table>
	
	</section>



	<section data-anytab-content='domainEvents' class='clearfix displayNone'>
	
	<table class='applyAnytable gridTable fullWidth'>
	<thead>
	<tr>
		<td>ID</td>
		<td>Event</td>
		<td>Class</td>
		<td>Time/Date</td>
	</tr>
	</thead>
	<tbody data-bind="var: shipping(@HISTORY); format:processList; loadsTemplate:domainManagerHistoryRowTemplate;">
	</tbody>
	</table>
	
	</section>

	</div>



</div>













<!--
//////////////////////////  PROJECTS \\\\\\\\\\\\\\\\\\\\\\\\\
-->






<table>
<tbody id='projectsListTemplate'>
<tr>
	<td class='isSearchable' data-bind="var: projects(TITLE); format:text;"></td>
	<td class='isSearchable' data-bind="var: projects(TYPE); format:text;"></td>
	<td class='alignRight'>
	<span data-bind="useParentData:true; format:projectButtons; extension:admin_sites;"></span>
	<button class='applyButton' data-app-click='admin_sites|projectDetailShow' data-icon-primary='ui-icon-pencil' data-text='false'>View Details</button>
	</td>
</tr>


<tr class='displayNone'>
	<td colspan='3'>
	<div class='marginLeft'>
		<div  data-bind="var: project(ID); format:text; pretext:ID: ;"></div>
		<div  data-bind="var: project(TYPE); format:text; pretext:Type: ;"></div>
		<div  data-bind="var: project(CREATED_TS); format:text; pretext:Created: ;"></div>
		<div  data-bind="var: project(UPDATED_TS); format:text; pretext:Last update: ;"></div>
		<div  data-bind="var: project(APP_VERSION); format:text; pretext:App version: ;"></div>
		<div  data-bind="var: project(APP_RELEASE); format:text; pretext:App release: ;"></div>
		<div  data-bind="var: project(APP_ROOT); format:text; pretext:App root: ;"></div>
		<div  data-bind="var: project(GITHUB_REPO); format:text; pretext:GitHub repository: ;"></div>
		<div  data-bind="var: project(GITHUB_BRANCH); format:text; pretext:GitHub branch: ;"></div>
		<div  data-bind="var: project(APP_EXPIRE); format:text; pretext:Expiration: ;"></div>
		<div  data-bind="var: project(UPDATED_TS); format:text; pretext:Last update: ;"></div>
	</div>
	</td>
</tr>
</tbody>
</table>




<div id='projectCreateTemplate'>

<form onSubmit='return false'>
<fieldset class='labelsAsBreaks alignedLabels alignedInputs'>
	<label>
	<span>Project title</span>
	<input type="text" name="title" required='required' />
	<span class='toolTip' title="ex: domain.com master">?</span>
	</label>


	<label>
	<span>Project type</span>
	<select name="type" >
		<option value="APP">Shopping App (index.html)</option>
<!--		<option value="VSTORE">Legacy vStore Project (beta)</option> -->
		<option value="ADMIN">Hosted Admin App (beta)</option>
		<option value="CHECKOUT">Checkout Intercept (beta)</option>
		<option value="DSS">Decision Support System (beta)</option>
	</select>
	</label>


	<label>
	<span>GitHub repo</span>
	<input type="url" name="repo" maxlength="128" required='required' />
	</label>
	<p class="hint">ex: http://github.com/yourname/project.git<br />
	At this time only GITHUB hosted projects with public http urls are supported.
	</p>

	<label>
	<span>GitHub branch</span>
	<input type="text" name="branch" maxlength="20" />
	</label>
	
<!--	<label><input type="checkbox" name="domain"> Reserve a test domain for this project.</label> -->
	<div class='buttonset'>
		<button class='applyButton' data-app-click="admin_sites|projectCreateExec">Save</button>
	</div>
</fieldset>
</form>

</div>


