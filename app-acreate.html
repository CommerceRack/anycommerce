<!doctype html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<title>Administrative Interface Login</title>

<META HTTP-EQUIV="Pragma" CONTENT="no-cache"><!-- don't cache this file. -->
<META NAME="ROBOTS" CONTENT="NONE">

<script type="text/javascript">

var myCreole;

var baseURL = '';
//in admin, used for loading app-specific files. do NOT set the base href tho.
if (document.location.protocol  == 'file:') { 
	baseURL = '';
	}
else if (document.location.port == 8888) {
	// local webserver (node.js?)
	baseURL = '/';
	}
else {
   baseURL = "";
   }

var app = {vars:{
	/////////////////////////////////\
	"release":"201344.a",   ///|> Increment this with each change. model version followed by each deployed update getting a new letter in the alphabet.
	//////////////////////////////////
	"thisSessionIsAdmin": true,
	"_clientid":"admin",
	"jqurl": (document.location.protocol == 'file:') ? "https://www.zoovy.com/jsonapi/" : "/jsonapi/",
//	"jqurl": (document.domain.indexOf('anycommerce') > -1) ?  "https://www.anycommerce.com/webapi/jquery/index.cgi" : "https://www.zoovy.com/webapi/jquery/index.cgi",
//	"secureURL" : "https://www.zoovy.com",
	"username": "", //needs to be set for header and media library. gets set in admin.initUserInterface
	"baseURL" : baseURL,
	},u:{},rq:[]};

</script>

<!--
all css includes need to be after the js that changes the base url.
css files should be included before any .js file to ensure they are downloaded in parallel
-->
<link rel="stylesheet" type="text/css" href="app-acreate/styles.css">
<link rel="stylesheet" type="text/css" href="app-admin/jquery-ui-1.10.3.custom.css" /><!-- tho the jqueryui js lib isn't used for this app, the styles are (for now) -->

<!-- not much is going to run without these two. load em early -->
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>
<!-- <script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.10.3/jquery-ui.min.js"></script>-->

<script type="text/javascript" src="controller.js"></script>
<script type="text/javascript" src="model.js"></script>
<script type="text/javascript" src="includes.js"></script>
<script type='text/javascript' src='app-acreate/extension.js'></script>

<!-- <script type="text/javascript" src="loadscript.js"></script> -->

<script type="text/javascript">
//don't execute script till both jquery AND the dom are ready.
$(document).ready(function(){
	var tmp = new zController(app);
//instantiate wiki parser.
	myCreole = new Parse.Simple.Creole();
	app.model.addExtensions([{'namespace':'lookup','filename':'app-login/extension.js','callback':'initExtension'}]);
	app.u.handleEventDelegation($(document.body));
	});


/*
linked in docs:
https://developer.linkedin.com/documents/getting-started-javascript-api
*/


//here for quick testing.  will need to be moved into extension when it's working.
function initTwitter()	{
	$.ajax({
		url : 'https://api.twitter.com/oauth/request_token?oauth_token=57002332-tQEaz11fELPxhQSsEnZ65LFNQzlbHMUDdlCzTsZlV'//,
//		beforeSend : function(xhr)	{
//			xhr.setRequestHeader('Authorization ','OAuth oauth_consumer_key="yMN0fyj927LHqbE43WphBA", oauth_nonce="kYjzVBB8Y0ZFabxSWbWovY3uYSQ2pTgmZeNu2VS4cg", oauth_signature="tnnArxj06cWHq44gCs1OSKk%2FjLY%3D", oauth_signature_method="HMAC-SHA1", oauth_timestamp="1318622958", oauth_token="370773112-GmHxMAgYyLbNEtIKZeRNFsMKPR9EyMZeS9weJAEb", oauth_version="1.0"'); //set by app
//			}
		});
//	var twitRequest = $.ajax('https://api.twitter.com/oauth/authenticate?oauth_token=57002332-tQEaz11fELPxhQSsEnZ65LFNQzlbHMUDdlCzTsZlV');
	}

</script>







</head>
<body class="control">
<!-- this div handles getting content to appear below the fixed header -->

<div id='appLookup' class='ui-widget ui-widget-content ui-corner-all'>
	
	<div class='logo alignCenter stdMargin'><a href="/index.html"><img src='app-admin/images/zoovy_logo-173x30.png' width='173' height='30' alt='zoovy' /></a></div>


	<div>
		<p>Connect With</p>
		
		<div class='alignCenter clearfix marginBottom'>
		
			<span class='threePLSprite twitter' onClick="initTwitter();"></span>
<!--			<span class='threePLSprite facebook'></span> -->
			<span class='treatAsthreePLSprite'><fb:login-button show-faces="false" width="200" max-rows="1"></fb:login-button></span>
			<span class='threePLSprite linkedin'></span>
			<span class='threePLSprite yahoo'></span>
			<span class='threePLSprite openid'></span>
			<span class='threePLSprite google'></span>
		
		</div>
	
	</div>


	<div class='hint stdMargin' id='loginFormContainer'>
	<form action='#'>
	<fieldset class='authNewAccountCreate labelsAsBreaks alignedLabels alignedInputs'>
		<legend>Create Account</legend>
<!--
we should be able to get this much from whatever service they use.
		<label><span>First Name: </span><input type='text' name='firstname' required='required' /></label>
		<label><span>Last Name: </span><input type='text' name='lastname' required='required' /></label>
		<label><span>Email: </span><input type='email' name='email' required='required' /></label>
-->		<label><span>Company/DBA: </span><input type='text' name='company' maxlength="30" required='required' /></label>
		<div class='helper marginBottom'>company name will be your username. 10 char limit</div>
		<label><span>Domain: </span><input type='url' name='domain' required='required' placeholder='http://' value="" /></label>
		<label><span>Phone: </span><input type='tel' name='phone' required='required' size='10' /></label>
		<div class='alignRight'>
			<button>Create Account</button>
		</div>
	</fieldset>
	</form>
	</div>

</div>

<div id="fb-root"></div>
<script>
//http://developers.facebook.com/docs/facebook-login/getting-started-web/
  // Additional JS functions here
  window.fbAsyncInit = function() {
    FB.init({
      appId      : '717808051580347', // App ID
      channelUrl : 'app-acreate/channel.html', // Channel File
      status     : true, // check login status
      cookie     : true, // enable cookies to allow the server to access the session
      xfbml      : true  // parse XFBML
    });

    // Additional init code here

  };

  // Load the SDK asynchronously
  (function(d){
     var js, id = 'facebook-jssdk', ref = d.getElementsByTagName('script')[0];
     if (d.getElementById(id)) {return;}
     js = d.createElement('script'); js.id = id; js.async = true;
     js.src = (document.location.protocol == 'file:' ? 'http:' : '')+"//connect.facebook.net/en_US/all.js";
     ref.parentNode.insertBefore(js, ref);
   }(document));

  FB.Event.subscribe('auth.authResponseChange', function(response) {
    // Here we specify what we do with the response anytime this event occurs. 
    if (response.status === 'connected') {
      testAPI();
    } else if (response.status === 'not_authorized') {
      FB.login();
    } else {
      FB.login();
    }
  });


  // Load the SDK asynchronously
  (function(d){
   var js, id = 'facebook-jssdk', ref = d.getElementsByTagName('script')[0];
   if (d.getElementById(id)) {return;}
   js = d.createElement('script'); js.id = id; js.async = true;
   js.src = "//connect.facebook.net/en_US/all.js";
   ref.parentNode.insertBefore(js, ref);
  }(document));

  // Here we run a very simple test of the Graph API after login is successful. 
  // This testAPI() function is only called in those cases. 
  function testAPI() {
    console.log('Welcome!  Fetching your information.... ');
    FB.api('/me', function(response) {
      console.log('Good to see you, ' + response.name + '.');
    });
  }


</script>

</body>
</html>
